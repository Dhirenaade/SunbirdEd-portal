<div>
  <sui-modal *ngIf="!programContext.questionType" [mustScroll]="true" [isClosable]="true" [transitionDuration]="0"
    [size]="'small'" class="sb-modal" appBodyScroll
    (dismissed)="programContext.questionType; dismissPublishModal();" #modal>
    <div class="sb-modal-header">
      Select Question Category
    </div>
    <div class="sb-modal-content">
      <ul>
        <li (click)="selectQuestionCategory(contentType)"
          *ngFor="let contentType of templateDetails.questionCategories">
          {{contentType}}
        </li>
      </ul>
    </div>
  </sui-modal>  
</div>


<!-- Untitled Practice Set Section with text field -->
<div class="d-flex sb-bg-color-gray-0 practical-header">
  <div class="d-flex flex-ai-center practical-header__content ui container">
    <div class="mr-auto" *ngIf="!showTextArea">
      <div class="practice-set__label">
        <span class="font-weight-bold fs-1-143">Untiled Practice Set</span>
        <a class="cursor-pointer fs-0-785 ml-8" (click)="showTextArea=!showTextArea">Edit</a>
      </div>
      <div class="mt-8 practice-set__status">
          <!-- <span class="sb-label sb-label-table sb-label-success-0">Review</span>
          <span class="sb-label sb-label-table sb-label-warning-0">Review/Warning</span>
          <span class="sb-label sb-label-table sb-label-error-0">Error</span> -->
        <span class="sb-label sb-label-table sb-label-gray-100">Review</span>
        <span class="cursor-pointer fs-0-785 ml-8"><i class="comment alternate outline icon sb-color-primary"></i><a>View Comments</a></span>
      </div>
    </div>
    <div class="sb-field-group textbook-edit mr-auto" *ngIf="showTextArea">
      <div class="sb-field relative">
        <textarea rows="4" name="moretext" class="sb-form-control fs-1" placeholder="Type here..."></textarea>
        <span class="characters-left">200 Characters left</span>
      </div>
    </div>
    <div class='practical-sb-buttons'>
      <button class="sb-btn sb-btn-primary sb-btn-normal ripple mr-8" (click)="showTextArea=!showTextArea">Save</button>
      <button class="sb-btn sb-btn-outline-primary sb-btn-normal ripple mr-8">Preview</button>
      <button class="sb-btn sb-btn-secondary sb-btn-normal ripple" (click)="showTextArea=!showTextArea">Submit</button>
    </div>
  </div>
</div> 

<div class="ui container">
  <div *ngIf="programContext?.questionType" class="ui twelve column grid m-0">
    <div class="three wide column p-0">

      <div class="d-flex flex-ai-center" *ngIf="role.currentRole === 'PUBLISHER'">
        <div class="sb-checkbox sb-checkbox-primary">
          <input type="checkbox" [(ngModel)]="selectedAll" appTelemetryInteract
            [telemetryInteractEdata]="{id:'select_all_questions',type:'click',pageid:'questionlist'}"
            (change)="selectAll();">
          <label for="check1">Select All</label>
        </div>
      </div>

      <!-- Question list Section -->

      <div class="d-flex width-100 flex-jc-center mt-24">
        <button *ngIf="role.currentRole === 'CONTRIBUTOR'"
          [disabled]="questionMetaData && questionMetaData.mode === 'create'" (click)="createNewQuestion()"
          appTelemetryInteract
          [telemetryInteractEdata]="{id:'create_btn',type:'click',pageid:'questionlist',extra:{type:'reference',category:programContext.questionType.toUpperCase(),topic:programContext.topic}}"
          class="sb-btn sb-btn-primary sb-btn-normal sb-left-icon-btn"><i class="add icon"></i>Add new Question</button>
      </div>

      <div class="question-list">
        <div class="question-list__item active d-flex flex-ai-center p-16 cursor-pointer"
          [class.active]="selectedQuestionId === question.identifier"
          (click)="handleQuestionTabChange(question.identifier)" *ngFor="let question of questionList; let i = index"
          appTelemetryInteract
          [telemetryInteractEdata]="{id:'question_tab',type:'click',pageid:'questionlist',extra:{type:'reference',identifier:question.identifier}}">
          <label class="mb-0 mr-auto" for="check1"> Question {{i + 1}}</label>
          <i class="info circle sb-color-warning fs-1 icon" *ngIf="question.status === 'Reject'"></i>
          <i class="trash alternate outline icon ml-24" *ngIf="question.status != 'Review' && question.status != 'Live'"></i>
          <i class="move icon ml-16 sb-color-primary ml-24"></i>
        </div>
      </div>

    </div>

    <div class="nine wide column bg-white pl-40 p-0 ckeditor-container">
      <div *ngIf="!questionList.length && questionMetaData?.mode !== 'create' && role.currentRole === 'CONTRIBUTOR'"
        class="ui segment">No Question - Click
        Create</div>
      <div *ngIf="!questionList.length && role.currentRole === 'REVIEWER'" class="ui segment">No Questions for Review
      </div>
      <div *ngIf="(questionList.length || questionMetaData?.mode === 'create')&& refresh">
        <div *ngIf="programContext.questionType === 'mcq'" class="ui segment">
          <div [hidden]="showLoader">
            <app-mcq-creation [programContext]="programContext" [questionMetaData]="questionMetaData"
              [questionSelectionStatus]="questionSelectionStatus" [role]="role"
              (questionStatus)="questionStatusHandler($event)"
              (questionQueueStatus)="questionQueueStatusHandler($event)">
            </app-mcq-creation>
          </div>
        </div>
        <div *ngIf="programContext.questionType !== 'mcq'" class="ui segment">
          <div [hidden]="showLoader">
            <app-question-creation [programContext]="programContext" [questionMetaData]="questionMetaData"
              [questionSelectionStatus]="questionSelectionStatus" [role]="role"
              (questionStatus)="questionStatusHandler($event)"
              (questionQueueStatus)="questionQueueStatusHandler($event)">
            </app-question-creation>
          </div>
        </div>
      </div>
      <app-loader *ngIf='showLoader'></app-loader>
    </div>
  </div>

</div>

<sui-modal *ngIf="showSuccessModal" [mustScroll]="true" [isClosable]="true" [transitionDuration]="0" [size]="'small'"
  class="sb-modal" appBodyScroll (dismissed)="showSuccessModal = !showSuccessModal; dismissPublishModal();" #modal>
  <div class="sb-modal-header">
    Practice Set Successfully Published
  </div>
  <div class="sb-modal-content">
    <p>Name : {{resourceName}} </p>
    <p>Board : {{programContext.board}} </p>
    <p>Medium : {{programContext.medium}} </p>
    <p>Class : {{programContext.gradeLevel}} </p>
    <p>Subject : {{programContext.subject}} </p>
    <p>ResourceID : {{publishedResourceId}} </p>
    Preview Link : <a target="_blank" href="https://diksha.gov.in/play/content/{{publishedResourceId}}">Click here</a>
  </div>

  <div class="sb-modal-actions">
    <button class="sb-btn sb-btn-normal sb-btn-outline-primary"
      (click)="showSuccessModal = !showSuccessModal; dismissPublishModal();">
      Close
    </button>
  </div>
</sui-modal>
