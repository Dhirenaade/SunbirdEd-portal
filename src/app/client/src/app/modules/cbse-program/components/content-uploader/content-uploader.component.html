<div class="d-flex sb-bg-color-gray-0 practical-header">
  <div class="d-flex flex-ai-center flex-jc-space-between practical-header__content ui container">
    <div #contentTitle class="font-weight-bold fs-1" *ngIf="!showTextArea">
      {{editTitle}} <span class="fs-0-785 pl-8"><a *ngIf="visibility && visibility.showEdit" class="cursor-pointer" (click)="showTextArea = !showTextArea">Edit</a></span>
      <div class="mt-8 practice-set__status">
        <span class="sb-label sb-label-table sb-label-success-0"
        [ngClass]="{ 'sb-label-success-0': resourceStatus == 'Live', 'sb-label-warning-0': resourceStatus == 'Draft',  'sb-label-error-0': resourceStatus == 'Rejected',  'sb-label-gray-0': resourceStatus == 'Review' }">{{ resourceStatus }}</span>
        <span class="cursor-pointer fs-0-785 ml-8"
          *ngIf="resourceDetails && resourceDetails.rejectComment && (sessionContext.currentRoleId === 1)"><i class="comment alternate outline icon sb-color-primary"></i><a (click)="showReviewModal=!showReviewModal">View Comments</a></span>
      </div>
    </div>
    <div class="sb-field-group textbook-edit" *ngIf="showTextArea">
      <div class="sb-field relative">
        <textarea rows="4" name="moretext" class="sb-form-control" placeholder="Type here..." [(ngModel)]="editTitle"></textarea>
        <span class="characters-left">200 Characters left</span>
      </div>
    </div>
    <div class='practical-sb-buttons'>
      <button id="saveContent" *ngIf="visibility && visibility.showSave" class="sb-btn sb-btn-outline-primary sb-btn-normal mr-8 ripple" (click)="saveContent()">Save</button>
      <button id="changeContent" *ngIf="visibility && visibility.showChangeFile && resourceStatus === 'Draft'" class="sb-btn sb-btn-outline-primary sb-btn-normal ripple mr-8" (click)="changeFile()">Change
        File</button>
      <button id="requestChanges" *ngIf="visibility && visibility.showRequestChanges && resourceStatus === 'Review'" class="sb-btn sb-btn-error sb-btn-normal ripple mr-8" (click)="showRequestChangesPopup = true;">Request Changes</button>
      <button id="publishContent" *ngIf="visibility && visibility.showPublish && resourceStatus === 'Review'" class="sb-btn sb-btn-secondary sb-btn-normal ripple mr-8" (click)="publichContent()">Publish</button>
      <button id="submitContent" *ngIf="visibility && visibility.showSubmit && resourceStatus === 'Draft'" class="sb-btn sb-btn-secondary sb-btn-normal ripple" (click)="saveContent('review')">Submit</button>
    </div>
  </div>
</div> 


<div class="middle-section-set" *ngIf="showPreview">
    <div class="ui container msg-box">
      <div class="msg-box__content">
        <div class="container msg-box__content__blank-box">
            <app-player class="content-player" [playerConfig]="playerConfig"></app-player>
        </div>
      </div>
    </div>
</div>

<!-- <div> -->
<sui-modal *ngIf="showUploadModal" [mustScroll]="true" [isClosable]="true" [transitionDuration]="0" [size]="'normal'"
    class="sb-modal sb-file-upload-modal" appBodyScroll (dismissed)="closeUploadModal()" #modal>
    <div type="text/template" id="qq-template-validation" #fineUploaderUI>
      <div class="qq-uploader-selector qq-uploader custom-qq-uploader">
        <div class="qq-upload-drop-area-selector qq-upload-drop-area" qq-hide-dropzone>
          <span class="qq-upload-drop-area-text-selector"></span>
        </div>
        <span class="qq-drop-processing-selector qq-drop-processing">
          <span>Processing dropped files...</span>
          <span class="qq-drop-processing-spinner-selector qq-drop-processing-spinner"></span>
        </span>
        <ul class="qq-upload-list-selector qq-upload-list custom-qq-upload-list" aria-live="polite"
          aria-relevant="additions removals">
          <li>
            <div class="qq-progress-bar-container-selector">
              <div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
                class="qq-progress-bar-selector qq-progress-bar"></div>
            </div>
            <span class="qq-upload-spinner-selector qq-upload-spinner"></span>
            <img class="qq-thumbnail-selector" qq-max-size="100" qq-server-scale>
            <span class="qq-upload-file-selector qq-upload-file custom-qq-upload-file"></span>
            <span class="qq-upload-size-selector qq-upload-size"></span>
            <button type="button" class="qq-btn qq-upload-retry-selector qq-upload-retry">Retry</button>
            <button type="button" class="qq-btn qq-upload-delete-selector qq-upload-delete">Delete</button>
            <span role="status" class="qq-upload-status-text-selector qq-upload-status-text"></span>
          </li>
        </ul>
        <div id="qq-upload-actions" class="upload-file-description d-flex flex-ai-center flex-dc">
          <h5 class="mb-8">Drop Files here</h5>
          <span class="fs-0-92 mb-8">Or</span>
          <div class="qq-upload-button-selector qq-upload-button sb-btn sb-btn-normal sb-btn-success">
            <div>Select Files</div>
          </div>
          <p class="mt-8">You can upload {{templateDetails.filesConfig.accepted}} files ( Max size 50 MB )</p>
        </div>
        <dialog class="qq-confirm-dialog-selector">
          <div class="qq-dialog-message-selector"></div>
          <div class="qq-dialog-buttons">
            <button type="button" class="qq-cancel-button-selector">No</button>
            <button type="button" class="qq-ok-button-selector">Yes</button>
          </div>
        </dialog>
        <dialog class="qq-prompt-dialog-selector">
          <div class="qq-dialog-message-selector"></div>
          <input type="text">
          <div class="qq-dialog-buttons">
            <button type="button" class="qq-cancel-button-selector">Cancel</button>
            <button type="button" class="qq-ok-button-selector">Ok</button>
          </div>
        </dialog>
      </div>
    </div>
    <div class="sb-modal-header">Upload Files</div>
    <div class="sb-modal-content">
    <div *ngIf="!loading">
      <div  id="upload-content-div" class="upload-file-section"></div>
    </div>
      <div *ngIf='!loading' class="upload-file-description pt-16">
        <ul>
          <li>File accepted - {{templateDetails.filesConfig.accepted}}</li>
          <li>Max file size - {{templateDetails.filesConfig.size}} Mb</li>
        </ul>
      </div>
      <div *ngIf='loading' class="uploading-files">
          <div class='d-flex flex-dc flex-jc-center flex-ai-center icon'>
            <img src="assets/images/loader.gif" width="64" class='process-icon'>
            <!-- <div class="fs-0-785 pt-16">120 MB Uploading Files (65%)
            </div> -->
            <!-- <sui-progress [value]="60" [maximum]="100" class="mb-0 mr-0"></sui-progress> -->
          </div>
          <div class="text-center fs-0-785">"By Uploading asset on SunbirdEd, you consent to publish it
            under the Creative Commons License Framework
          </div>
          <div class="text-center fs-0-785 pt-4 links"><a href="javascript:void(0);">https://creativecommons.org/licenses
              .</a></div>
        </div>
    </div>
    <div class="sb-modal-actions">
      <button id="uploadContent" class="sb-btn sb-btn-normal ml-8" [ngClass]="{'sb-btn-primary': uploadButton, 'sb-btn-disabled': !uploadButton}" (click)="uploadContent()">Upload</button>
      <button (click)="closeUploadModal()" class="sb-btn sb-btn-outline-primary sb-btn-normal">Cancel</button>
    </div>
  </sui-modal>
<!-- </div> -->

<sui-modal *ngIf="showRequestChangesPopup" [mustScroll]="true" [isClosable]="true" [transitionDuration]="0"
  [size]="'normal'" class="sb-modal" appBodyScroll #modal (dismissed)="showRequestChangesPopup = false;">
  <div class="sb-modal-header">
      Add Review Comments
  </div>
  <form #FormControl="ngForm" class="ui form">
  <div class="sb-modal-content">
      <div class="sb-field-group">
          <label>Enter your comments</label>
          <div class="sb-field relative">
            
              <textarea type="text" class="wmd-input width-100 sb-form-control" id="wmd-input" [(ngModel)]="rejectComment" placeholder="Add comment" name="rejectComment" required></textarea>
              <label class="ui basic red error label pt-1 mt-5 width-100"
                  *ngIf="FormControl.form.controls.rejectComment?.touched && !FormControl.form.valid">Fill comments </label>
            
              <!-- <textarea rows="4" name="moretext" class="sb-form-control" placeholder="Type here..."></textarea>
              <span class="characters-left">1000 Characters left</span> -->
          </div>
      </div>
  </div>
  <div class="sb-modal-actions">
    <button id="submitReview" type="submit" class="sb-btn sb-btn-normal" [ngClass]="{'sb-btn-primary': FormControl.form.valid, 'sb-btn-disabled': !FormControl.form.valid}"   (click)="requestChanges()"> Submit Review </button>
  </div>
</form>
</sui-modal>

<sui-modal *ngIf="showReviewModal" [mustScroll]="true" [isClosable]="true" [transitionDuration]="0"
  [size]="'normal'" class="sb-modal" appBodyScroll
  (dismissed)="showReviewModal = !showReviewModal" #modal>
  <div class="sb-modal-header">
      Review Comments
  </div>
  <div class="sb-modal-content">
      <div class="sb-publish-content">
        <div class="review-modal-list">
          <!-- <ol class="list">
            <li class="pb-8">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled </li>
            <li class="pb-8">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled </li>
            <li class="pb-8">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled </li>
          </ol> -->
          {{contentMetaData?.rejectComment}}
      </div>
      </div>
  </div>
  <!-- <div class="sb-modal-actions">
    <button type="button" class="sb-btn sb-btn-normal sb-btn-primary"> Continue </button>
  </div> -->
</sui-modal>

<div *ngIf="showForm && showPreview">
  <form #contentForm [formGroup]="contentDetailsForm" (ngSubmit)="saveContent()" class='ui container licence-form mt-24' >
      <div class='licence-form__content__fields px-24 py-16 d-flex flex-w-wrap'>
        
          <div class="sb-field pr-8" formArrayName="selectionArr" *ngFor = "let field of selectionFields; let i = index ">
            <div [formGroupName]="i">
              <label class="font-weight-bold">{{field.label}}:</label>
              <sui-select *ngIf="!disableFormField" formControlName="{{field.code}}" class="selection" [isDisabled]="disableFormField" placeholder="{{field.placeholder}}">
                <sui-select-option *ngFor="let option of selectOutcomeOption[field.code]" [value]="option">
                </sui-select-option>
              </sui-select>
              <div *ngIf="disableFormField"><label>{{contentMetaData[field.code]}}</label></div>
              <label class="warning-message" *ngIf="((selectionArr.controls[i].get(field.code).touched) && (selectionArr.controls[i].get(field.code).errors?.required))">* This field is mandatory</label>
            </div>
          </div>
  
          <div class="sb-field pr-8" formArrayName="multiSelectionArr" *ngFor = "let field of multiSelectionFields; let i = index ">
              <div [formGroupName]="i">
                  <label class="font-weight-bold">{{field.label}}:</label>
                  <sui-multi-select *ngIf="!disableFormField" formControlName="{{field.code}}" class="selection" [isDisabled]="disableFormField" placeholder="{{field.placeholder}}">
                    <sui-select-option *ngFor="let option of selectOutcomeOption[field.code]" [value]="option">
                    </sui-select-option>
                  </sui-multi-select>
                  <div *ngIf="disableFormField"><label>{{contentMetaData[field.code]}}</label></div>
                  <label class="warning-message" *ngIf="((multiSelectionArr.controls[i].get(field.code).touched) && (multiSelectionArr.controls[i].get(field.code).errors?.required))">* This field is mandatory</label>
              </div>
          </div>
       
          <div class="sb-field pr-8" formArrayName="textInputArr" *ngFor = "let field of textFields; let i = index ">
            <div [formGroupName]="i">
              <label class="font-weight-bold">{{field.label}}:</label>
                <input *ngIf="!disableFormField" formControlName="{{field.code}}" type="{{field.inputType}}" name="{{field.code}}" class="sb-form-control" placeholder="{{field.placeholder}}">
                <div *ngIf="disableFormField"><label>{{contentMetaData[field.code]}}</label></div>
              <label class="warning-message" *ngIf="((textInputArr.controls[i].get(field.code).touched) && (textInputArr.controls[i].get(field.code).errors?.required))">* This field is mandatory</label>
            </div>
          </div> 
  
      </div>
  
      <p class="paragraph fs-0-785">
        “By creating content on SunbirdEd, you consent to publish it under the Creative Commons License Framework
        <span class="link font-weight-bold">https://creativecommons.org/licenses .</span>
        Please choose the applicable creative commons license you wish to apply to your content”.
      </p>
  
  </form>
  </div>